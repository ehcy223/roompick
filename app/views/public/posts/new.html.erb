<% content_for :title, "新規投稿" %>

<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">

      <h1 class="h3 mb-3">新規投稿</h1>

      <div class="card shadow-sm">
        <div class="card-body">
          <%= form_with model: @post, local: true, html: { multipart: true, class: "post-form" } do |f| %>
            <%= render "public/shared/error_messages", resource: f.object %>

            <!-- タイトル -->
            <div class="mb-3">
              <%= f.label :title, "タイトル", class: "form-label" %>
              <%= f.text_field :title, class: "form-control", required: true, placeholder: "例）一人暮らしに最適な加湿器" %>
            </div>

            <!-- カテゴリ -->
            <div class="mb-3">
              <%= f.label :category_id, "カテゴリー", class: "form-label" %>
              <%= f.collection_select :category_id,
                    Category.order(:name), :id, :name,
                    { prompt: "選択してください" },
                    { class: "form-select", required: true } %>
            </div>

            <!-- 本文 -->
            <div class="mb-3">
              <%= f.label :body, "本文", class: "form-label" %>
              <%= f.text_area :body, rows: 6, class: "form-control", placeholder: "使ってみた感想やおすすめポイントを書いてください" %>
            </div>

            <!-- 評価（5段階）-->
            <div class="mb-3">
              <%= f.label :rating, "評価", class: "form-label" %>
              <%= f.select :rating, (1..5).to_a, { prompt: "選択してください" }, class: "form-select", required: true %>
            </div>

            <!-- 画像 -->
            <div class="mb-3">
              <%= f.label :image, "画像アップロード", class: "form-label" %>
              <%= f.file_field :image, accept: "image/*", class: "form-control", data: { controller: "preview" } %>
              <img id="image-preview" alt="プレビュー" class="img-fluid rounded d-none mt-2" />
            </div>

            <!-- ボタン -->
            <div class="d-flex gap-2">
              <%= f.submit "投稿する", class: "btn btn-primary btn-lg" %>
              <%= link_to "キャンセル", posts_path, class: "btn btn-outline-secondary" %>
            </div>
          <% end %>
        </div>
      </div>

    </div>
  </div>
</div>